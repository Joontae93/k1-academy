(()=>{"use strict";function e(e,t=!1){return!1===t?document.querySelector(e):document.querySelectorAll(e)}function t(e){return document.getElementById(e)}function s(e){return document.getElementById(e).value}const o=`${k1AcademyData.root_url}/wp-json/llms/v1/`;async function n(e,t="GET",s=!1,n=!1){e="accessPlans"===e?"access-plans":e;try{const r={headers:{"Content-Type":"application/json","X-LLMS-CONSUMER-KEY":process.env.API_KEY,"X-LLMS-CONSUMER-SECRET":process.env.API_SECRET},method:`${t}`,timeout:5e3};s&&(r.body=JSON.stringify(s)),console.log(r);const c=await fetch(o+`${e}`,r),a=await c.json();if(!c.ok)throw new Error(`${a.message} (${c.status})`);return n?[c,a,t]:a}catch(e){}}const r={accessPlans:[],courses:[],groups:[],memberships:[]},c=new class{#e=t("jsNotice");#t=t("custom-sales-form");#s=e(".the-courses");constructor(){this.#e&&(this.#e.innerHTML="")}addHandlerSubmit(e){this.#t.addEventListener("submit",(t=>{t.preventDefault(),e(this.getFormData())}))}showCourses(e){e.forEach((e=>{const t=`\n\t\t\t<div class="course">\n\t\t\t\t<input type="checkbox" value="${e.id}" name="${e.name}" id="${e.name}"><label>${e.name}</label>\n\t\t\t</div>\n\t\t\t`;this.#s.insertAdjacentHTML("afterbegin",t)}))}getFormData(){const o={user:{},org:{employees:{},volunteers:{},get total(){return this.employees.ft+this.employees.pt+this.volunteers}},courses:{ids:[]}};return o.user.firstName=s("user-first-name"),o.user.lastName=s("user-last-name"),o.user.email=s("user-email"),o.org.type=s("org-type"),o.org.name=s("org-name"),o.org.employees.ft=s("employee--full"),o.org.employees.pt=s("employee--part"),o.org.volunteers=s("volunteers"),e(".course",!0).forEach((e=>{const s=t(e.querySelector("label").textContent);s.checked&&o.courses.ids.push(+s.value)})),o}_getFormDatav2(){return[...new FormData(this.#t)]}checkout(e){window.location.href=`https://academy.kingdomone.co/checkout/?=${e}`}},a={init:async function(){try{console.log("Loading Form..."),await async function(e){(await n("courses")).forEach((e=>{const t={id:e.id,link:e.permalink,status:e.status,name:e.title.rendered};r.courses.push(t)}))}(),c.showCourses(r.courses),c.addHandlerSubmit(this.submitForm),await async function(e){try{["memberships","accessPlans","groups"].forEach((async e=>{(await n(e)).forEach((t=>{switch(e){case"memberships":const e={id:t.id};r.memberships.push(e);break;case"accessPlans":const s={id:t.id};r.accessPlans.push(s);break;case"groups":const o={id:t.id};r.groups.push(o)}}))}))}catch(e){console.error(e)}}()}catch(e){console.error(e)}},submitForm:async function(e){r.form={...e},console.log("Form Submitted! Doing AJAX....");try{await async function(){console.log("Creating assets..."),Object.entries(r).forEach((e=>{const[t,s]=e}));const e={title:"Course created via API Request",content:"This is the content of the course. It is hilariously short."};try{const t=await n("courses","POST",e,!0);console.log(t)}catch(e){console.error(e)}}()}catch(e){console.error(e)}}};document.getElementById("copyright").innerHTML=`<p>&copy; ${k1AcademyData.year} Kingdom One All Rights Reserved.`,e(".llms-sd-item",!0).forEach(((e,t)=>{e.children.length<1||(e.children[1].style.display="none")})),"/sales/"===window.location.pathname&&a.init()})();